<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Automate Your Helm Chart Testing Workflow with GitHub Actions | Tanmay Bhat</title><meta name=keywords content="Helm,Kubernetes"><meta name=description content="Helm is a popular open-source package manager for Kubernetes that simplifies the process of installing, upgrading, and managing applications on a Kubernetes cluster. Helm packages, called charts, contain all the necessary resources and configuration for deploying an application on a Kubernetes cluster.
As with any software project, it&rsquo;s important to test charts before deploying them to ensure that they are reliable and function as intended. Chart testing is the process of verifying the functionality and correctness of a Helm chart before it is deployed to a Kubernetes cluster."><meta name=author content="Tanmay Bhat"><link rel=canonical href=https://tanmay-bhat.github.io/posts/helm-chart-testing-github-actions/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bccfefac377bc340f06c260aed1bddf49a4354816d7c570d6aac75a997986c95.css integrity="sha256-vM/vrDd7w0DwbCYK7Rvd9JpDVIFtfFcNaqx1qZeYbJU=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://tanmay-bhat.github.io/memoji.png><link rel=icon type=image/png sizes=16x16 href=https://tanmay-bhat.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://tanmay-bhat.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://tanmay-bhat.github.io/apple-touch-icon.png><link rel=mask-icon href=https://tanmay-bhat.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-6PXF78BGMY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6PXF78BGMY",{anonymize_ip:!1})}</script><meta property="og:title" content="Automate Your Helm Chart Testing Workflow with GitHub Actions"><meta property="og:description" content="Helm is a popular open-source package manager for Kubernetes that simplifies the process of installing, upgrading, and managing applications on a Kubernetes cluster. Helm packages, called charts, contain all the necessary resources and configuration for deploying an application on a Kubernetes cluster.
As with any software project, it&rsquo;s important to test charts before deploying them to ensure that they are reliable and function as intended. Chart testing is the process of verifying the functionality and correctness of a Helm chart before it is deployed to a Kubernetes cluster."><meta property="og:type" content="article"><meta property="og:url" content="https://tanmay-bhat.github.io/posts/helm-chart-testing-github-actions/"><meta property="og:image" content="https://tanmay-bhat.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-27T00:00:00+00:00"><meta property="article:modified_time" content="2022-12-27T00:00:00+00:00"><meta property="og:site_name" content="Tanmay Bhat"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tanmay-bhat.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Automate Your Helm Chart Testing Workflow with GitHub Actions"><meta name=twitter:description content="Helm is a popular open-source package manager for Kubernetes that simplifies the process of installing, upgrading, and managing applications on a Kubernetes cluster. Helm packages, called charts, contain all the necessary resources and configuration for deploying an application on a Kubernetes cluster.
As with any software project, it&rsquo;s important to test charts before deploying them to ensure that they are reliable and function as intended. Chart testing is the process of verifying the functionality and correctness of a Helm chart before it is deployed to a Kubernetes cluster."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://tanmay-bhat.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Automate Your Helm Chart Testing Workflow with GitHub Actions","item":"https://tanmay-bhat.github.io/posts/helm-chart-testing-github-actions/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Automate Your Helm Chart Testing Workflow with GitHub Actions","name":"Automate Your Helm Chart Testing Workflow with GitHub Actions","description":"Helm is a popular open-source package manager for Kubernetes that simplifies the process of installing, upgrading, and managing applications on a Kubernetes cluster. Helm packages, called charts, contain all the necessary resources and configuration for deploying an application on a Kubernetes cluster.\nAs with any software project, it\u0026rsquo;s important to test charts before deploying them to ensure that they are reliable and function as intended. Chart testing is the process of verifying the functionality and correctness of a Helm chart before it is deployed to a Kubernetes cluster.","keywords":["Helm","Kubernetes"],"articleBody":"Helm is a popular open-source package manager for Kubernetes that simplifies the process of installing, upgrading, and managing applications on a Kubernetes cluster. Helm packages, called charts, contain all the necessary resources and configuration for deploying an application on a Kubernetes cluster.\nAs with any software project, it’s important to test charts before deploying them to ensure that they are reliable and function as intended. Chart testing is the process of verifying the functionality and correctness of a Helm chart before it is deployed to a Kubernetes cluster.\nThere are a variety of tools and approaches available for testing Helm charts, ranging from simple shell scripts to more advanced testing frameworks. In this blog post, we’ll explore how to use the chart-testing tool, which is maintained by the Helm project, to test Helm charts with GitHub Actions.\nHelm Chart Testing with Pull Requests Lets create a new file in the .GitHub/workflows directory of your repository called chart-testing.yml. This file will define the workflow and specify the steps required to run the chart tests. Update the chart-testing.yml file with below contents :\nname: Lint and Test Charts on: pull_request jobs: lint-test: runs-on: ubuntu-latest steps: - name: Checkout uses: actions/checkout@v3 with: fetch-depth: 0 - name: Set up Helm uses: azure/setup-helm@v3 - name: Set up Python uses: actions/setup-python@v4 with: python-version: 3.7 - name: Set up chart-testing uses: helm/chart-testing-action@v2.3.1 - name: Run chart-testing (list-changed) id: list-changed run: | changed=$(ct list-changed --config ct.yaml) if [[ -n \"$changed\" ]]; then echo \"{changed}={true}\" \u003e\u003e $GitHub_OUTPUT fi - name: Run chart-testing (lint) run: ct lint --config ct.yaml - name: Create kind cluster uses: helm/kind-action@v1.5.0 if: ${{ needs.list-changed.outputs.changed }} == 'true' - name: Run chart-testing (install) run: ct install --config ct.yaml Let’s understand the above config in detail.\non: pull_request : This indicates when the workflow should trigger, in our case whenever a pull request is opened. Checkout: This step uses the actions/checkout@v3 action to check out (clone) the code in the repository so that the workflow can access it. The fetch-depth parameter is set to 0 to fetch the entire repository history i.e all history for all branches and tags. Set up Helm: This step uses the azure/setup-helm@v3 action to install and set up Helm v3 latest on the machine. Set up Python: This step uses the actions/setup-python@v4 action to install and set up Python on the machine. The python-version parameter is set to 3.7. Set up chart-testing: This step uses the helm/chart-testing-action@v2.3.1 action to install and set up chart-testing, a tool for testing Helm charts. Run chart-testing (list-changed): This step runs the ct list-changed command using chart-testing to list the charts that have changed since the last commit by referring to the main target branch. The id field is used to give this step an identifier, which can be used to reference it later in the workflow execution. If there are changed charts, the step sets an output named changed to true using the echo \"{changed}={true}\" \u003e\u003e $GitHub_OUTPUT syntax. Run chart-testing (lint): This step runs the ct lint command using chart-testing to lint the charts in the repository. Create kind cluster: This step uses the helm/kind-action@v1.5.0 action to create a Kubernetes cluster using kind (Kubernetes IN Docker). The if field is used to specify that this step should only be run if the changed output of the list-changed step is true. I.e this step will only run if there are changes in the helm charts compared to main branch helm charts, basically git diff between them result should not be empty. Run chart-testing (install): This step runs the ct install command using chart-testing to install the charts in the repository into the kind cluster. Now, create a file called ct.yaml which will store the configs for the chart-testing: target-branch: main chart-dirs: - deploy/helm/charts helm-extra-args: --timeout 600s check-version-increment: false The target-branch field specifies the target branch used to identify changed charts.\nThe chart-dirs field specifies the directories where the charts to be tested are located. In this case, the value is deploy/charts, which means that the charts are located in the deploy/charts directory. Update this according to your directory structure.\nThe helm-extra-args field specifies additional arguments to pass to the Helm command when installing or upgrading charts. In this case, the value is --timeout 600s, which means that the Helm command will have a timeout of 600 seconds (10 minutes).\nThe check-version-increment field specifies whether chart-testing should check that the chart version is incremented in Chart.yaml. In this case, the value is false\nThe directory structure finally looks like this :\nRepository └── ct.yaml └── Deploy └── Charts └── example-helm-chart ├── Chart.yaml ├── templates │ ├── deployment.yaml │ ├── ingress.yaml │ ├── service.yaml └── values.yaml Now that we have configure, we can see the flow in action.\nConsider a case where we wanted to enable Ingress for my app, but didn’t complete the all correct values in the helm chart and pushed to my test-branch .\n#supplied values for my-app ingress: enabled: true annotations: {} hosts: - host: chart-example.local paths: [] #I didn't specify the path and helm install should fail. As you can see the below, the Action failed :\nSince the problem is with helm templating, the lint step passsed sucessfully.\nRun ct lint --config ct.yaml Linting charts... ------------------------------------------------------------------------------------------------------------------------ Charts to be processed: ------------------------------------------------------------------------------------------------------------------------ my-app =\u003e (version: \"0.2.8\", path: \"charts/my-app\") ------------------------------------------------------------------------------------------------------------------------ Linting chart \"my-app =\u003e (version: \\\"0.2.8\\\", path: \\\"charts/my-app\\\")\" Validating /home/runner/work/helm-actions-demo/my-app/Chart.yaml... Validation success! 👍 Validating maintainers... ==\u003e Linting /charts/my-app 1 chart(s) linted, 0 chart(s) failed ------------------------------------------------------------------------------------------------------------------------ ✔︎ example-v2 =\u003e (version: \"0.2.8\", path: \"charts/my-app\") ------------------------------------------------------------------------------------------------------------------------ All charts linted successfully Helm templating and helm install should fail since the Ingress config is incomplete : Run ct install --config ct.yaml Installing charts... ------------------------------------------------------------------------------------------------------------------------ Charts to be processed: ------------------------------------------------------------------------------------------------------------------------ my-app =\u003e (version: \"0.2.8\", path: \"charts/my-app\") ------------------------------------------------------------------------------------------------------------------------ Installing chart \"my-app =\u003e (version: \\\"0.2.8\\\", path: \\\"my-app\\\")\"... Error: INSTALLATION FAILED: Ingress.extensions \"my-app-ingress\" is invalid: spec.rules[0].http.paths: Required value Trigger GitHub Actions for Push and other Events Similar to the above config, you can just configure GitHub actions to trigger whenever a push to the main (or any other) branch happens. Or you can combine the trigger with push and pull request.\n#For both on: [pull_request,push] #For Push event on: push #For push to specifc branches on: push: branches: - main - test-branch #For PR on specific branches on: pull_request: branches: - main - develop You can more about GitHub workflow trigger events here.\nSpecifying Multiple Helm Values Files You can specify values in a folder called cilocated in the root of your chart repository. The ci folder should contain a values.yamlfile with the desired values, and chart-testing will automatically use these values when running the ct installcommand.\nFor example, if you have a chart repository with the following structure:\nRepository └── ct.yaml └── Deploy └── Charts └── example-helm-chart ├── ci │ ├── values-us-east-1.yaml │ ├── values-us-west-2.yaml │ └── values-eu-west-1.yaml ├── Chart.yaml ├── templates │ ├── deployment.yaml │ ├── ingress.yaml │ ├── service.yaml └── values.yaml It will iterate over every values-*.yaml and the chart is installed and tested for each of these files.\nHelm Upgrades To test an in-place upgrade of a chart, you can use the upgrade flag with the ct install command. This flag will cause chart-testing to test an in-place upgrade of the chart from its previous revision.\nAdd upgrade: true into your ct.yaml to enable the upgrade of the Helm charts.\nIf the current version should not introduce a breaking change according to the SemVer specification, the upgrade will be tested.\nHandling Dependencies in Chart Testing When testing Helm charts that have dependencies on other charts, it is important to ensure that these dependencies are properly installed and configured in order for the tests to be successful. By default, ct install handles dependency of helm charts i.e it will run helm dependency build to fetch the chart specified.\nYou need to add the repository in ct.yaml so that repository index can be fetched, Bitnami in this example : chart-repos: - bitnami=https://charts.bitnami.com/bitnami Next, you need to specify the required chart in your Chart.yaml of your specific helm chart, Redis for Example : dependencies: - name: redis version: 17.4.0 repository: https://charts.bitnami.com/bitnami Then you can use your custom values for the Redis chart in the values.yaml, for example : redis: enabled: true cluster: enabled: false References : https://GitHub.com/helm/chart-testing\nhttps://GitHub.com/marketplace/actions/helm-chart-testing\nhttps://docs.GitHub.com/en/actions/using-jobs/using-jobs-in-a-workflow#overview\n","wordCount":"1376","inLanguage":"en","datePublished":"2022-12-27T00:00:00Z","dateModified":"2022-12-27T00:00:00Z","author":{"@type":"Person","name":"Tanmay Bhat"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tanmay-bhat.github.io/posts/helm-chart-testing-github-actions/"},"publisher":{"@type":"Organization","name":"Tanmay Bhat","logo":{"@type":"ImageObject","url":"https://tanmay-bhat.github.io/memoji.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tanmay-bhat.github.io accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tanmay-bhat.github.io/about/ title=About><span>About</span></a></li><li><a href=https://tanmay-bhat.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://tanmay-bhat.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tanmay-bhat.github.io>Home</a>&nbsp;»&nbsp;<a href=https://tanmay-bhat.github.io/posts/>Posts</a></div><h1 class=post-title>Automate Your Helm Chart Testing Workflow with GitHub Actions</h1><div class=post-meta><span title='2022-12-27 00:00:00 +0000 UTC'>December 27, 2022</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Tanmay Bhat&nbsp;|&nbsp;<a href=https://github.com/tanmay-bhat/tanmay-bhat.github.io/blob/main/content/posts/helm-chart-testing-github-actions.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>Helm is a popular open-source package manager for Kubernetes that simplifies the process of installing, upgrading, and managing applications on a Kubernetes cluster. Helm packages, called charts, contain all the necessary resources and configuration for deploying an application on a Kubernetes cluster.</p><p>As with any software project, it&rsquo;s important to test charts before deploying them to ensure that they are reliable and function as intended. Chart testing is the process of verifying the functionality and correctness of a Helm chart before it is deployed to a Kubernetes cluster.</p><p>There are a variety of tools and approaches available for testing Helm charts, ranging from simple shell scripts to more advanced testing frameworks. In this blog post, we&rsquo;ll explore how to use the <a href=https://GitHub.com/helm/chart-testing>chart-testing</a> tool, which is maintained by the Helm project, to test Helm charts with GitHub Actions.</p><h2 id=helm-chart-testing-with-pull-requests>Helm Chart Testing with Pull Requests<a hidden class=anchor aria-hidden=true href=#helm-chart-testing-with-pull-requests>#</a></h2><ol><li>Lets create a new file in the <code>.GitHub/workflows</code> directory of your repository called <code>chart-testing.yml</code>. This file will define the workflow and specify the steps required to run the chart tests.</li></ol><p>Update the <code>chart-testing.yml</code> file with below contents :</p><pre tabindex=0><code>name: Lint and Test Charts

on: pull_request

jobs:
  lint-test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Set up Helm
        uses: azure/setup-helm@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.7

      - name: Set up chart-testing
        uses: helm/chart-testing-action@v2.3.1

      - name: Run chart-testing (list-changed)
        id: list-changed
        run: |
          changed=$(ct list-changed --config ct.yaml)
          if [[ -n &#34;$changed&#34; ]]; then
            echo &#34;{changed}={true}&#34; &gt;&gt; $GitHub_OUTPUT
          fi

      - name: Run chart-testing (lint)
        run: ct lint --config ct.yaml

      - name: Create kind cluster
        uses: helm/kind-action@v1.5.0
        if: ${{ needs.list-changed.outputs.changed }} == &#39;true&#39;

      - name: Run chart-testing (install)
        run: ct install --config ct.yaml
</code></pre><p>Let’s understand the above config in detail.</p><ul><li><code>on: pull_request</code> : This indicates when the workflow should trigger, in our case whenever a pull request is opened.</li><li><code>Checkout</code>: This step uses the <code>actions/checkout@v3</code> action to check out (clone) the code in the repository so that the workflow can access it. The <code>fetch-depth</code> parameter is set to <code>0</code> to fetch the entire repository history i.e all history for all branches and tags.</li><li><code>Set up Helm</code>: This step uses the <code>azure/setup-helm@v3</code> action to install and set up Helm v3 latest on the machine.</li><li><code>Set up Python</code>: This step uses the <code>actions/setup-python@v4</code> action to install and set up Python on the machine. The <code>python-version</code> parameter is set to <code>3.7</code>.</li><li><code>Set up chart-testing</code>: This step uses the <code>helm/chart-testing-action@v2.3.1</code> action to install and set up chart-testing, a tool for testing Helm charts.</li><li><code>Run chart-testing (list-changed)</code>: This step runs the <code>ct list-changed</code> command using chart-testing to list the charts that have changed since the last commit by referring to the <code>main</code> target branch. The <code>id</code> field is used to give this step an identifier, which can be used to reference it later in the workflow execution. If there are changed charts, the step sets an output named <code>changed</code> to <code>true</code> using the <code>echo "{changed}={true}" >> $GitHub_OUTPUT</code> syntax.</li><li><code>Run chart-testing (lint)</code>: This step runs the <code>ct lint</code> command using chart-testing to lint the charts in the repository.</li><li><code>Create kind cluster</code>: This step uses the <code>helm/kind-action@v1.5.0</code> action to create a Kubernetes cluster using kind (Kubernetes IN Docker). The <code>if</code> field is used to specify that this step should only be run if the <code>changed</code> output of the <code>list-changed</code> step is <code>true</code>. I.e this step will only run if there are changes in the helm charts compared to main branch helm charts, basically git diff between them result should not be empty.</li><li><code>Run chart-testing (install)</code>: This step runs the <code>ct install</code> command using chart-testing to install the charts in the repository into the kind cluster.</li></ul><ol start=2><li>Now, create a file called <code>ct.yaml</code> which will store the configs for the chart-testing:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>target-branch: main
</span></span><span style=display:flex><span>chart-dirs:
</span></span><span style=display:flex><span>  - deploy/helm/charts
</span></span><span style=display:flex><span>helm-extra-args: --timeout 600s
</span></span><span style=display:flex><span>check-version-increment: false
</span></span></code></pre></div><ul><li><p>The <code>target-branch</code> field specifies the target branch used to identify changed charts.</p></li><li><p>The <code>chart-dirs</code> field specifies the directories where the charts to be tested are located. In this case, the value is <code>deploy/charts</code>, which means that the charts are located in the <code>deploy/charts</code> directory. Update this according to your directory structure.</p></li><li><p>The <code>helm-extra-args</code> field specifies additional arguments to pass to the Helm command when installing or upgrading charts. In this case, the value is <code>--timeout 600s</code>, which means that the Helm command will have a timeout of 600 seconds (10 minutes).</p></li><li><p>The <code>check-version-increment</code> field specifies whether chart-testing should check that the chart version is incremented in <code>Chart.yaml</code>. In this case, the value is <code>false</code></p></li></ul><p>The directory structure finally looks like this :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Repository
</span></span><span style=display:flex><span>└── ct.yaml
</span></span><span style=display:flex><span>└── Deploy
</span></span><span style=display:flex><span>		└── Charts
</span></span><span style=display:flex><span>		    └── example-helm-chart
</span></span><span style=display:flex><span>		        ├── Chart.yaml
</span></span><span style=display:flex><span>		        ├── templates
</span></span><span style=display:flex><span>		        │   ├── deployment.yaml
</span></span><span style=display:flex><span>		        │   ├── ingress.yaml
</span></span><span style=display:flex><span>		        │   ├── service.yaml
</span></span><span style=display:flex><span>		        └── values.yaml
</span></span></code></pre></div><p>Now that we have configure, we can see the flow in action.</p><p>Consider a case where we wanted to enable Ingress for my app, but didn’t complete the all correct values in the helm chart and pushed to my <code>test-branch</code> .</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#supplied values for my-app</span>
</span></span><span style=display:flex><span>ingress:
</span></span><span style=display:flex><span>  enabled: true
</span></span><span style=display:flex><span>  annotations: <span style=color:#f92672>{}</span>
</span></span><span style=display:flex><span>  hosts:
</span></span><span style=display:flex><span>    - host: chart-example.local
</span></span><span style=display:flex><span>      paths: <span style=color:#f92672>[]</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#I didn&#39;t specify the path and helm install should fail.</span>
</span></span></code></pre></div><p>As you can see the below, the Action failed :</p><p><img loading=lazy src=/helm-actions-fail.png alt=helm-actions-fail-image></p><p>Since the problem is with helm templating, the lint step passsed sucessfully.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Run ct lint --config ct.yaml
</span></span><span style=display:flex><span>Linting charts...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span> Charts to be processed:
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span>my-app <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>(</span>version: <span style=color:#e6db74>&#34;0.2.8&#34;</span>, path: <span style=color:#e6db74>&#34;charts/my-app&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Linting chart <span style=color:#e6db74>&#34;my-app =&gt; (version: \&#34;0.2.8\&#34;, path: \&#34;charts/my-app\&#34;)&#34;</span>
</span></span><span style=display:flex><span>Validating /home/runner/work/helm-actions-demo/my-app/Chart.yaml...
</span></span><span style=display:flex><span>Validation success! 👍
</span></span><span style=display:flex><span>Validating maintainers...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>==</span>&gt; Linting /charts/my-app
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> chart<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> linted, <span style=color:#ae81ff>0</span> chart<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span> failed
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span> ✔︎ example-v2 <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>(</span>version: <span style=color:#e6db74>&#34;0.2.8&#34;</span>, path: <span style=color:#e6db74>&#34;charts/my-app&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span>All charts linted successfully
</span></span></code></pre></div><ul><li>Helm templating and helm install should fail since the Ingress config is incomplete :</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Run ct install --config ct.yaml
</span></span><span style=display:flex><span>Installing charts...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span> Charts to be processed:
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span> my-app <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>(</span>version: <span style=color:#e6db74>&#34;0.2.8&#34;</span>, path: <span style=color:#e6db74>&#34;charts/my-app&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>------------------------------------------------------------------------------------------------------------------------
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Installing chart <span style=color:#e6db74>&#34;my-app =&gt; (version: \&#34;0.2.8\&#34;, path: \&#34;my-app\&#34;)&#34;</span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Error: INSTALLATION FAILED: Ingress.extensions <span style=color:#e6db74>&#34;my-app-ingress&#34;</span> is invalid: spec.rules<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span>.http.paths: Required value
</span></span></code></pre></div><h3 id=trigger-github-actions-for-push-and-other-events>Trigger GitHub Actions for Push and other Events<a hidden class=anchor aria-hidden=true href=#trigger-github-actions-for-push-and-other-events>#</a></h3><p>Similar to the above config, you can just configure GitHub actions to trigger whenever a push to the main (or any other) branch happens. Or you can combine the trigger with push and pull request.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#For both </span>
</span></span><span style=display:flex><span>on: <span style=color:#f92672>[</span>pull_request,push<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#For Push event</span>
</span></span><span style=display:flex><span>on: push
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#For push to specifc branches</span>
</span></span><span style=display:flex><span>on:
</span></span><span style=display:flex><span>  push:
</span></span><span style=display:flex><span>    branches:
</span></span><span style=display:flex><span>      - main
</span></span><span style=display:flex><span>      - test-branch
</span></span><span style=display:flex><span><span style=color:#75715e>#For PR on specific branches</span>
</span></span><span style=display:flex><span>on:
</span></span><span style=display:flex><span>  pull_request:
</span></span><span style=display:flex><span>    branches:
</span></span><span style=display:flex><span>      - main
</span></span><span style=display:flex><span>      - develop
</span></span></code></pre></div><p>You can more about GitHub workflow trigger events <a href=https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows>here</a>.</p><h2 id=specifying-multiple-helm-values-files>Specifying Multiple Helm Values Files<a hidden class=anchor aria-hidden=true href=#specifying-multiple-helm-values-files>#</a></h2><p>You can specify values in a folder called <code>ci</code>located in the root of your chart repository. The <code>ci</code> folder should contain a <code>values.yaml</code>file with the desired values, and chart-testing will automatically use these values when running the <code>ct install</code>command.</p><p>For example, if you have a chart repository with the following structure:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Repository
</span></span><span style=display:flex><span>└── ct.yaml
</span></span><span style=display:flex><span>└── Deploy
</span></span><span style=display:flex><span>		└── Charts
</span></span><span style=display:flex><span>		    └── example-helm-chart
</span></span><span style=display:flex><span>		        ├── ci
</span></span><span style=display:flex><span>		        │   ├── values-us-east-1.yaml
</span></span><span style=display:flex><span>		        │   ├── values-us-west-2.yaml
</span></span><span style=display:flex><span>		        │   └── values-eu-west-1.yaml
</span></span><span style=display:flex><span>		        ├── Chart.yaml
</span></span><span style=display:flex><span>		        ├── templates
</span></span><span style=display:flex><span>		        │   ├── deployment.yaml
</span></span><span style=display:flex><span>		        │   ├── ingress.yaml
</span></span><span style=display:flex><span>		        │   ├── service.yaml
</span></span><span style=display:flex><span>		        └── values.yaml
</span></span></code></pre></div><p>It will iterate over every <code>values-*.yaml</code> and the chart is installed and tested for each of these files.</p><h3 id=helm-upgrades>Helm Upgrades<a hidden class=anchor aria-hidden=true href=#helm-upgrades>#</a></h3><p>To test an in-place upgrade of a chart, you can use the <code>upgrade</code> flag with the <code>ct install</code>
command. This flag will cause chart-testing to test an in-place upgrade of the chart from its previous revision.</p><p>Add <code>upgrade: true</code> into your <code>ct.yaml</code> to enable the upgrade of the Helm charts.</p><p>If the current version should not introduce a breaking change according to the SemVer specification, the upgrade will be tested.</p><h3 id=handling-dependencies-in-chart-testing>Handling Dependencies in Chart Testing<a hidden class=anchor aria-hidden=true href=#handling-dependencies-in-chart-testing>#</a></h3><p>When testing Helm charts that have dependencies on other charts, it is important to ensure that these dependencies are properly installed and configured in order for the tests to be successful. By default, <code>ct install</code> handles dependency of helm charts i.e it will run <code>helm dependency build</code> to fetch the chart specified.</p><ul><li>You need to add the repository in <code>ct.yaml</code> so that repository index can be fetched, Bitnami in this example :</li></ul><pre tabindex=0><code>chart-repos:
  - bitnami=https://charts.bitnami.com/bitnami
</code></pre><ul><li>Next, you need to specify the required chart in your <code>Chart.yaml</code> of your specific helm chart, Redis for Example :</li></ul><pre tabindex=0><code>dependencies:
  - name: redis
    version: 17.4.0
    repository: https://charts.bitnami.com/bitnami
</code></pre><ul><li>Then you can use your custom values for the Redis chart in the <code>values.yaml</code>, for example :</li></ul><pre tabindex=0><code>redis:
  enabled: true
  cluster:
    enabled: false
</code></pre><hr><h3 id=references->References :<a hidden class=anchor aria-hidden=true href=#references->#</a></h3><p><a href=https://GitHub.com/helm/chart-testing>https://GitHub.com/helm/chart-testing</a></p><p><a href=https://GitHub.com/marketplace/actions/helm-chart-testing>https://GitHub.com/marketplace/actions/helm-chart-testing</a></p><p><a href=https://docs.GitHub.com/en/actions/using-jobs/using-jobs-in-a-workflow#overview>https://docs.GitHub.com/en/actions/using-jobs/using-jobs-in-a-workflow#overview</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://tanmay-bhat.github.io/tags/helm/>Helm</a></li><li><a href=https://tanmay-bhat.github.io/tags/kubernetes/>Kubernetes</a></li></ul><nav class=paginav><a class=next href=https://tanmay-bhat.github.io/posts/monitor-gaming-laptop-using-grafana-ohmgraphite/><span class=title>Next »</span><br><span>Monitor Gaming Laptop Using Grafana and OhmGraphite</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Automate Your Helm Chart Testing Workflow with GitHub Actions on twitter" href="https://twitter.com/intent/tweet/?text=Automate%20Your%20Helm%20Chart%20Testing%20Workflow%20with%20GitHub%20Actions&url=https%3a%2f%2ftanmay-bhat.github.io%2fposts%2fhelm-chart-testing-github-actions%2f&hashtags=Helm%2cKubernetes"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Automate Your Helm Chart Testing Workflow with GitHub Actions on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ftanmay-bhat.github.io%2fposts%2fhelm-chart-testing-github-actions%2f&title=Automate%20Your%20Helm%20Chart%20Testing%20Workflow%20with%20GitHub%20Actions&summary=Automate%20Your%20Helm%20Chart%20Testing%20Workflow%20with%20GitHub%20Actions&source=https%3a%2f%2ftanmay-bhat.github.io%2fposts%2fhelm-chart-testing-github-actions%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Automate Your Helm Chart Testing Workflow with GitHub Actions on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ftanmay-bhat.github.io%2fposts%2fhelm-chart-testing-github-actions%2f&title=Automate%20Your%20Helm%20Chart%20Testing%20Workflow%20with%20GitHub%20Actions"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Automate Your Helm Chart Testing Workflow with GitHub Actions on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ftanmay-bhat.github.io%2fposts%2fhelm-chart-testing-github-actions%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Automate Your Helm Chart Testing Workflow with GitHub Actions on whatsapp" href="https://api.whatsapp.com/send?text=Automate%20Your%20Helm%20Chart%20Testing%20Workflow%20with%20GitHub%20Actions%20-%20https%3a%2f%2ftanmay-bhat.github.io%2fposts%2fhelm-chart-testing-github-actions%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Automate Your Helm Chart Testing Workflow with GitHub Actions on telegram" href="https://telegram.me/share/url?text=Automate%20Your%20Helm%20Chart%20Testing%20Workflow%20with%20GitHub%20Actions&url=https%3a%2f%2ftanmay-bhat.github.io%2fposts%2fhelm-chart-testing-github-actions%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://tanmay-bhat.github.io>Tanmay Bhat</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>